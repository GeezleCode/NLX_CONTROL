<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of spk_TrialEventWindow</title>
  <meta name="keywords" content="spk_TrialEventWindow">
  <meta name="description" content="returns the time window between two specified events">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">@al_spk</a> &gt; spk_TrialEventWindow.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for @al_spk&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>spk_TrialEventWindow
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>returns the time window between two specified events</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [TimeWin,AlignTimes,s] = spk_TrialEventWindow(s,LoEventLabel,HiEventLabel,EventNr) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> returns the time window between two specified events
 trials are give in s.currenttrials; set by &gt;&gt;spk_set(s,'currentrials',[ ... ])
 NOTE: if there multiple events of the LoEventLabel type HiEvent is
 defined as the next event in time after LoEvent(EventNr).

 [TimeWin,AlignTimes,s] = spk_TrialEventWindow(s,LoEventLabel,HiEventLabel,EventNr)

 INPUT
 LoEventLabel,HiEventLabel ..... event names as defined in
                                 s.eventlabels
 EventNr ....................... number of event for each trial

 OUTPUT
 TimeWin ...... two column array, trials in rows
 AlignTimes ... column vector of align times for each trial</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="error.html" class="code" title="function msgOut = error(s,msgIn,caller)">error</a>	Report an error that occurred in a spike object</li><li><a href="spk_TrialNum.html" class="code" title="function total = spk_TrialNum(s)">spk_TrialNum</a>	returns and check for number of trials in @al_spk object</li><li><a href="spk_findEventlabel.html" class="code" title="function i = spk_findEventlabel(s,eventlabel)">spk_findEventlabel</a>	returns the index of an eventlabel</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [TimeWin,AlignTimes,s] = spk_TrialEventWindow(s,LoEventLabel,HiEventLabel,EventNr)</a>
0002 
0003 <span class="comment">% returns the time window between two specified events</span>
0004 <span class="comment">% trials are give in s.currenttrials; set by &gt;&gt;spk_set(s,'currentrials',[ ... ])</span>
0005 <span class="comment">% NOTE: if there multiple events of the LoEventLabel type HiEvent is</span>
0006 <span class="comment">% defined as the next event in time after LoEvent(EventNr).</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% [TimeWin,AlignTimes,s] = spk_TrialEventWindow(s,LoEventLabel,HiEventLabel,EventNr)</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% INPUT</span>
0011 <span class="comment">% LoEventLabel,HiEventLabel ..... event names as defined in</span>
0012 <span class="comment">%                                 s.eventlabels</span>
0013 <span class="comment">% EventNr ....................... number of event for each trial</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% OUTPUT</span>
0016 <span class="comment">% TimeWin ...... two column array, trials in rows</span>
0017 <span class="comment">% AlignTimes ... column vector of align times for each trial</span>
0018 
0019 TrialNum = <a href="spk_TrialNum.html" class="code" title="function total = spk_TrialNum(s)">spk_TrialNum</a>(s);
0020 <span class="keyword">if</span> isempty(s.currenttrials)
0021     s.currenttrials = 1:TrialNum;
0022 <span class="keyword">end</span>
0023 CurrTrialNum = length(s.currenttrials);
0024 
0025 TimeWin = ones(CurrTrialNum,2).*NaN;
0026 AlignTimes = ones(CurrTrialNum,1).*NaN;
0027 <span class="keyword">if</span> nargin&lt;4
0028     EventNr = ones(CurrTrialNum,1);
0029 <span class="keyword">end</span>
0030 <span class="keyword">if</span> length(EventNr)~=CurrTrialNum
0031     <a href="error.html" class="code" title="function msgOut = error(s,msgIn,caller)">error</a>(<span class="string">'EventNr array must be same size as s.currenttrials !!!'</span>);
0032 <span class="keyword">end</span>
0033 
0034 LoEventLabelIndex = <a href="spk_findEventlabel.html" class="code" title="function i = spk_findEventlabel(s,eventlabel)">spk_findEventlabel</a>(s,LoEventLabel);
0035 HiEventLabelIndex = <a href="spk_findEventlabel.html" class="code" title="function i = spk_findEventlabel(s,eventlabel)">spk_findEventlabel</a>(s,HiEventLabel);
0036 
0037 <span class="keyword">for</span> i = 1:CurrTrialNum
0038     AllEventTime = cat(1,s.events{:,s.currenttrials(i)});
0039     LoEventTime = s.events{LoEventLabelIndex,s.currenttrials(i)};
0040     HiEventTime = s.events{HiEventLabelIndex,s.currenttrials(i)};
0041     
0042     <span class="comment">% check number of events of this particular type in this trial</span>
0043     NumLoEvent = length(LoEventTime);
0044     NumHiEvent = length(HiEventTime);
0045     
0046     <span class="comment">% check for multiple LO events</span>
0047     <span class="keyword">if</span> NumLoEvent&gt;1
0048         LoEventTime = LoEventTime(EventNr(i));
0049         <span class="keyword">if</span> any(HiEventTime&gt;LoEventTime)
0050             HiEventTime = HiEventTime(find(HiEventTime&gt;LoEventTime));<span class="comment">% take next of hi events</span>
0051             HiEventTime = HiEventTime(1);
0052         <span class="keyword">else</span>
0053             HiEventTime = cat(2,s.events{:,s.currenttrials(i)});
0054             <span class="keyword">if</span> any(HiEventTime&gt;LoEventTime)
0055                 HiEventTime = HiEventTime(find(HiEventTime&gt;LoEventTime));<span class="comment">% take next of all other events</span>
0056                 HiEventTime = HiEventTime(1);
0057             <span class="keyword">else</span>
0058                 HiEventTime = LoEventTime;
0059             <span class="keyword">end</span>
0060         <span class="keyword">end</span>
0061     <span class="keyword">end</span>
0062     
0063     <span class="keyword">if</span> NumHiEvent&gt;1
0064 <span class="comment">%         warning('multiple events in this trial');</span>
0065         HiEventTime = max(HiEventTime);
0066     <span class="keyword">end</span>
0067     
0068     TimeWin(i,1) = LoEventTime;
0069     TimeWin(i,2) = HiEventTime;
0070     AlignTimes(i,1) = s.align(s.currenttrials(i));
0071     
0072 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 05-Nov-2009 11:31:16 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>