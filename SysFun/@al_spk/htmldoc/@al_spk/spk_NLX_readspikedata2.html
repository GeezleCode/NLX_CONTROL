<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of spk_NLX_readspikedata2</title>
  <meta name="keywords" content="spk_NLX_readspikedata2">
  <meta name="description" content="reads spike data from a neuralynx *.nse file">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">@al_spk</a> &gt; spk_NLX_readspikedata2.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for @al_spk&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>spk_NLX_readspikedata2
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>reads spike data from a neuralynx *.nse file</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function s = spk_nlxreadspikedata2(s,NLXFileName,NLXTrialWin,NLXFileWin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> reads spike data from a neuralynx *.nse file

 s = spk_nlxreadspikedata2(s,NLXFileName,NLXTrialWin,NLXFileWin)

 NLXFileName ............ complete path to file, empty to force gui to pull up
 NLXTrialWin ............. time window for every trial in NLX time, trials along rows.
 NLXFileWin .............. time window in NLX time to extract data from NLX file</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function s = spk_nlxreadspikedata2(s,NLXFileName,NLXTrialWin,NLXFileWin)</a>
0002 
0003 <span class="comment">% reads spike data from a neuralynx *.nse file</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% s = spk_nlxreadspikedata2(s,NLXFileName,NLXTrialWin,NLXFileWin)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% NLXFileName ............ complete path to file, empty to force gui to pull up</span>
0008 <span class="comment">% NLXTrialWin ............. time window for every trial in NLX time, trials along rows.</span>
0009 <span class="comment">% NLXFileWin .............. time window in NLX time to extract data from NLX file</span>
0010 
0011 <span class="comment">% read Neuralynx File</span>
0012 <span class="keyword">if</span> nargin&lt;2 | isempty(NLXFileName)
0013     [NLXFileName,nlxPath] = uigetfile(<span class="string">'*.NSE'</span>,<span class="string">'load NEURALYNX *.NSE - file'</span>);
0014     <span class="keyword">if</span> NLXFileName==0;<span class="keyword">return</span>;<span class="keyword">end</span>
0015     NLXFileName = fullfile(nlxPath,NLXFileName);
0016 <span class="keyword">end</span>
0017 
0018 <span class="comment">%----------------------------------------------------------</span>
0019 <span class="comment">% Extraction Modes</span>
0020 <span class="comment">%     1. Extract All - This will extract every record from the file into the matlab environment;</span>
0021 <span class="comment">%     2. Extract Record Index Range = This will extract every Record whos index is within a range specified by Paramter 5.</span>
0022 <span class="comment">%     3. Extract Record Index List = This will extract every Record whos index in the file is the same index that is specified by Paramter 5.</span>
0023 <span class="comment">%     4. Extract Timestamp Range = This will extract every Record whos timestamp is within a range specified by Paramter 5.</span>
0024 <span class="comment">%     5. Extract Timestamp List = This will extract every Record with the same timestamp that is specified by Paramter 5.</span>
0025 <span class="comment">%     [TimeStamps, ScNumbers, CellNumbers, Params, DataPoints, NlxHeader] = Nlx2MatSpike_v3( ...</span>
0026 [TimeStamps, ScNumbers, CellNumbers] = Nlx2MatSpike_v3( <span class="keyword">...</span>
0027     NLXFileName, <span class="keyword">...</span>
0028     [1 1 1 0 0], <span class="keyword">...</span><span class="comment"> Timestamps,Sc Numbers,Cell Numbers,Params,Data Points</span>
0029     0, <span class="keyword">...</span><span class="comment"> extract header</span>
0030     4, <span class="keyword">...</span><span class="comment"> extraction mode</span>
0031     NLXFileWin);<span class="comment">% ... mode array</span>
0032 
0033 NLXcells = unique(CellNumbers);
0034 NLXcellNum = length(NLXcells);
0035 <span class="comment">%----------------------------------------------------------</span>
0036 
0037 <span class="comment">% clear object from spike data</span>
0038 numTrials = size(s.spk,2);
0039 <span class="comment">% s.spk = {};</span>
0040 s.channel = {};
0041 currChannels = [];
0042     
0043 
0044 <span class="comment">% loop trials</span>
0045 hwait = waitbar(0,<span class="string">'Extract spikes from neuralynx NSE file ...'</span>);
0046 <span class="keyword">for</span> i = 1:numTrials
0047     
0048     <span class="comment">% load spike times into object</span>
0049     <span class="keyword">for</span> j = 1:NLXcellNum
0050         
0051         <span class="keyword">if</span> ~ismember(num2str(NLXcells(j)),s.channel)
0052             s.channel = [s.channel;{num2str(NLXcells(j))}];
0053         <span class="keyword">end</span>
0054         chanInd = find(ismember(s.channel,num2str(NLXcells(j))));
0055         
0056         s.spk{chanInd,i} =  TimeStamps(CellNumbers==NLXcells(j) &amp; TimeStamps&gt;=NLXTrialWin(i,1) &amp; TimeStamps&lt;=NLXTrialWin(i,2)) .* 0.001 - s.align(i);
0057     <span class="keyword">if</span> i == 214
0058         s.spk{chanInd,i} =  TimeStamps(CellNumbers==NLXcells(j) &amp; TimeStamps&gt;=NLXTrialWin(i,1) &amp; TimeStamps&lt;=6761000000) .* 0.001 - s.align(i);
0059     <span class="keyword">end</span>
0060         
0061     <span class="keyword">end</span>
0062         
0063     
0064     waitbar(i/numTrials,hwait);
0065 <span class="keyword">end</span>
0066 close(hwait);
0067 
0068     
0069</pre></div>
<hr><address>Generated on Thu 05-Nov-2009 11:31:16 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>